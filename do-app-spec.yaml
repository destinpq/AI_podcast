name: ai-podcast-app # Choose a unique name for your app
region: nyc # Choose a region (e.g., nyc, sfo, lon, fra)

services:
  # Backend NestJS Service
  - name: backend
    git:
      repo: https://github.com/pratikk94/ai_podcast.git # Your repo URL
      branch: main
      deploy_on_push: true
    source_dir: /backend
    dockerfile_path: Dockerfile # We'll add a Dockerfile for better control (Optional but recommended)
    # build_command: npm run build # Alternative if not using Dockerfile
    # run_command: npm run start:prod # Alternative if not using Dockerfile
    http_port: 3001
    instance_size_slug: basic-xs # Choose an appropriate size
    instance_count: 1
    routes:
      - path: / # Expose backend at the root of its subdomain
    envs:
      - key: PORT
        value: "3001"
      - key: CLIENT_URL
        value: "UPDATE_WITH_FRONTEND_URL" # Placeholder - UPDATE IN UI LATER
      - key: OPENAI_API_KEY
        value: "ADD_SECRET_IN_UI" # Placeholder - ADD SECRET IN UI LATER
        type: SECRET
      # Add any other backend-specific env vars here

  # Frontend Next.js Service
  - name: frontend
    git:
      repo: https://github.com/pratikk94/ai_podcast.git # Your repo URL
      branch: main
      deploy_on_push: true
    source_dir: /
    build_command: npm run build:frontend
    run_command: npm run start:frontend
    http_port: 3000
    instance_size_slug: basic-xs # Choose an appropriate size
    instance_count: 1
    routes:
      - path: / # Expose frontend at the root of its subdomain
    envs:
      - key: NEXT_PUBLIC_BACKEND_URL
        value: "UPDATE_WITH_BACKEND_URL" # Placeholder - UPDATE IN UI LATER
      - key: NEXT_PUBLIC_FIREBASE_API_KEY
        value: "YOUR_FIREBASE_API_KEY" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
        value: "YOUR_FIREBASE_AUTH_DOMAIN" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_DATABASE_URL
        value: "YOUR_FIREBASE_DATABASE_URL" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_PROJECT_ID
        value: "YOUR_FIREBASE_PROJECT_ID" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
        value: "YOUR_FIREBASE_STORAGE_BUCKET" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
        value: "YOUR_FIREBASE_MESSAGING_SENDER_ID" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_APP_ID
        value: "YOUR_FIREBASE_APP_ID" # Replace or set in UI
      - key: NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID
        value: "YOUR_FIREBASE_MEASUREMENT_ID" # Replace or set in UI
      # Note: NEXT_PUBLIC_* vars should have type: GENERAL (default) 